{# templates/equipment/request_detail.html #}
{% extends "equipment/base.html" %}
{% load static %}

{% block title %}Request Details{% endblock %}

{% block content %}
<h2 class="mb-4">Request #{{ req.pk }}</h2>

<table class="table table-bordered">
    <tbody>
        <tr><th>Requester</th><td>{{ req.user.get_full_name|default:req.user.username }}</td></tr>
        <tr><th>Equipment</th><td>{{ req.equipment.name }}</td></tr>
        <tr><th>Period</th><td>{{ req.start_date }} – {{ req.end_date }}</td></tr>
        <tr><th>Status</th><td>
            {% if req.status == 'P' %}
                <span class="badge bg-warning text-dark">Pending</span>
            {% elif req.status == 'A' %}
                <span class="badge bg-success">Approved</span>
            {% else %}
                <span class="badge bg-danger">Rejected</span>
            {% endif %}
        </td></tr>
        <tr><th>Comments</th><td>{{ req.comments|default:"—" }}</td></tr>
    </tbody>
</table>

{% if req.status == 'P' and role != 'employee' %}
<div class="d-flex gap-2">
    <!-- ОДОБРЕНИЕ -->
    <form method="post" action="{% url 'EquipSense:approve_request' req.pk %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-success">Approve</button>
    </form>

    <!-- ОТКЛОНЕНИЕ -->
    <form method="post" action="{% url 'EquipSense:reject_request' req.pk %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">Reject</button>
    </form>
</div>
{% endif %}

<div class="mt-3">
    <a href="{% url 'EquipSense:manager_dashboard' %}" class="btn btn-secondary">Back to Dashboard</a>
</div>
{% endblock %}
